---
layout: default
title: M-SOLUTIONS プロコンオープン 2020-E M's Solution
---

# **AtCoder 精進記録**
[TOP page](../)
## M-SOLUTIONS プロコンオープン 2020-E M's Solution

|点数|実行時間|メモリ|
|:-:|:-:|:-:|
|500|3 sec|1024 MB|

### 問題概要
座標平面上に、 $N$ 個の異なる点 $(X_i, Y_i)\ (i=1,\cdots,N)$ がある。それぞれに重み $P_i$ がある。  
はじめ、直線 $x=0$ と $y=0$が存在し、さらに $K$ 本まで直線を追加できる。追加できる直線は $x=(0以外の整数)$ または $y=(0以外の整数)$ である。  
$K=0,\cdots,N$ それぞれについて、コストの総和 $\sum_{i=1}^{N} P_i\cdot ((X_i, Y_i)から最も近い直線までの距離)$ を最小化せよ。

### 制約
- $1 \le N \le 15$
- $\|X_i\|, \|Y_i\| \le 10{,}000$
- $1 \le P_i \le 1{,}000{,}000$
- 点 $(X_i, Y_i)$ はすべて異なる
- 入力はすべて整数

### メモ
例えば $y=2\|x-1\|+\|x-3\|+3\|x-4\|$ は折れ線のグラフになり、最小値は折れるポイント $(x=1, 3, 4)$ が候補になるが、同様に本問題では $N$ 個の点のうち少なくとも1個を通る直線が候補になる。  
各点が(線なし,縦線あり,横線あり)のいずれかであるとして全探索すると $O(N\ 3^N)$ あるいは $O(N^2 \ 3^N)$ で、なんとか間に合った(2600 ms)。
